---
title: C++ 右值引用与移动构造函数
date: 2022-02-10 17:12:07
tags: C++
categories: C++
---
## 右值与右值引用
不能修改的值就是右值，右值一般为临时变量。常见的右值有字面常量值，返回右值的表达式。
所谓右值引用就是必须绑定到右值的引用。我们通过&&来获得右值引用。
右值引用有一个重要的性质——只能绑定到一个将要销毁的对象。
因此，我们可以自由地将一个右值引用的资源“移动”到另一个对象中。
<!--more-->
``` cpp
void right_references()
{
    int i = 42;
    //r 为i的引用，左值引用
    int &r = i;
    //rr 不可以引用左值i，
    //因为其是右值引用
    //int &&rr = i;
    //表达式是一个右值
    //不能用左值引用
    //int &r2 = i*42;
    //可以将const引用绑定到右值上
    const int &r3 = i * 42;
    //将rr2绑定到乘法结果上
    int &&rr2 = i * 42;
}
```
上述代码右值引用只能捕获右值，左值引用只能捕获左值。const 引用可以捕获右值。
左值更长久，右值是短暂的。
``` cpp
void right_references()
{
    //右值引用捕获字面常量值
    int &&rr1 = 42;
    //右值引用不能捕获左值
    //因为rr1为左值，下面操作非法
    //int &&rr2 = rr1;
}
```
变量是左值，因此我们不能将一个右值引用直接绑定到一个变量上，即使这个变量是右值引用类型也不行。
## move操作
可以通过move操作将一个左值转化为右值引用。
``` cpp
void right_references()
{
    //右值引用捕获字面常量值
    int &&rr1 = 42;
    //通过move将左值转化为右值引用
    int &&rr3 = std::move(rr1);
}
```
